#!/bin/bash
# input-control â€” X11 altÄ±nda klavye/fare kontrol aracÄ±
# KullanÄ±m:
#   ./input-control off mouse
#   ./input-control on keyboard
#   ./input-control off all

ACTION=$1      # "on" veya "off"
TARGET=$2      # "mouse" | "keyboard" | "all"

USER=$(who | awk '/:0/{print $1; exit}')
XAUTH="/home/$USER/.Xauthority"
export DISPLAY=:0
export XAUTHORITY=$XAUTH

if [[ -z "$ACTION" || -z "$TARGET" ]]; then
    echo "KullanÄ±m: $0 [on|off] [mouse|keyboard|all]"
    exit 1
fi

echo "ğŸ§© KullanÄ±cÄ±: $USER"
echo "ğŸ“ XAUTHORITY: $XAUTH"

case "$ACTION" in
  off)
    echo "ğŸ”’ $TARGET devre dÄ±ÅŸÄ± bÄ±rakÄ±lÄ±yor..."
    ;;
  on)
    echo "ğŸ”“ $TARGET yeniden etkinleÅŸtiriliyor..."
    ;;
  *)
    echo "âŒ HatalÄ± eylem. 'on' veya 'off' yazmalÄ±sÄ±nÄ±z."
    exit 1
    ;;
esac

# Ä°lgili aygÄ±tlarÄ± bul
case "$TARGET" in
  mouse)
    DEVICES=$(xinput list | grep -E 'pointer' | grep -v 'XTEST' | sed -E 's/.*id=([0-9]+).*/\1/')
    ;;
  keyboard)
    DEVICES=$(xinput list | grep -E 'keyboard' | grep -v 'XTEST' | sed -E 's/.*id=([0-9]+).*/\1/')
    ;;
  all)
    DEVICES=$(xinput list | grep -E 'pointer|keyboard' | grep -v 'XTEST' | sed -E 's/.*id=([0-9]+).*/\1/')
    ;;
  *)
    echo "âŒ GeÃ§ersiz hedef. [mouse|keyboard|all] olmalÄ±."
    exit 1
    ;;
esac

# Ä°ÅŸlem uygula
for id in $DEVICES; do
    NAME=$(xinput list --name-only "$id")
    if [[ "$ACTION" == "off" ]]; then
        xinput disable "$id" && echo "â›” $NAME (ID: $id) devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"
    else
        xinput enable "$id" && echo "âœ… $NAME (ID: $id) etkinleÅŸtirildi"
    fi
done

