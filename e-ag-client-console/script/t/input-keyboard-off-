#!/bin/bash
# ğŸ”’ GerÃ§ek fiziksel klavyeleri devre dÄ±ÅŸÄ± bÄ±rakÄ±r (X11 iÃ§in)

USER=$(who | awk '/\(:0\)/ {print $1; exit}')
DISPLAY=":0"
XAUTHORITY="/home/$USER/.Xauthority"

if [ -z "$USER" ] || [ ! -f "$XAUTHORITY" ]; then
    echo "âŒ X oturumu veya XAUTHORITY bulunamadÄ±."
    exit 1
fi

# ğŸ”“ Root eriÅŸimine X11 izni ver
sudo -u "$USER" DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY xhost +SI:localuser:root >/dev/null 2>&1

# ğŸ” Kernel seviyesinde klavye cihazlarÄ±nÄ± bul
KEYBOARD_EVENTS=($(grep -E 'Handlers|EV=' /proc/bus/input/devices | grep -B1 "EV=1200" | grep "Handlers=" | sed -E 's/.*(event[0-9]+).*/\1/'))

echo "ğŸ§© Tespit edilen klavye event cihazlarÄ±: ${KEYBOARD_EVENTS[*]}"

sudo -u "$USER" DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY bash -c '
for id in $(xinput list | grep -Eo "id=[0-9]+" | cut -d= -f2); do
    name=$(xinput list --name-only "$id" 2>/dev/null)
    if xinput list-props "$id" 2>/dev/null | grep -qi "Keyboard"; then
        xinput disable "$id"
        echo "â›” $name (ID: $id) devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"
    fi
done
'

