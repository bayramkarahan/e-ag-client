#!/bin/bash
# Klavyeyi devre dÄ±ÅŸÄ± bÄ±rak (sade ve kesin sÃ¼rÃ¼m)
# ğŸ” Aktif kullanÄ±cÄ± ve DISPLAY bul
USER=$(who | grep -Eo "^[^ ]+" | head -n 1)
DISPLAY=$(who | grep -Eo "\(.*\)" | head -n 1 | tr -d '()')
XAUTHORITY="/home/$USER/.Xauthority"

# EÄŸer kullanÄ±cÄ± ya da XAUTHORITY bulunamazsa Ã§Ä±k
if [ -z "$USER" ] || [ ! -f "$XAUTHORITY" ]; then
    echo "âŒ X oturumu veya XAUTHORITY dosyasÄ± bulunamadÄ±."
    exit 1
fi

echo "ğŸ§© KullanÄ±cÄ±: $USER"
echo "ğŸ–¥ï¸ DISPLAY: $DISPLAY"
echo "ğŸ“ XAUTHORITY: $XAUTHORITY"
echo "ğŸ”’ Fiziksel KLAVYELER devre dÄ±ÅŸÄ± bÄ±rakÄ±lÄ±yor..."

# GerÃ§ek klavyeleri bul ve devre dÄ±ÅŸÄ± bÄ±rak
sudo -u "$USER" DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY bash -c '
xinput list --name-only | grep -Ei "keyboard|kbd|Translated|HID" | grep -viE "virtual|xtest|button" | while read -r name; do
    id=$(xinput list --id-only "$name" 2>/dev/null)
    if [ -n "$id" ]; then
        xinput disable "$id"
        echo "ğŸ”’ $name (id=$id) devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"
    fi
done
'
